---
icon: i-lucide-database
---
# registry

> Generic provider registry with priority-based matching. Use for model providers, tool resolvers, or any pluggable system.

## Usage
```ts
import { createRegistry, defineProvider } from 'unagent/registry'
```

## API

### createRegistry
Creates a registry that resolves inputs to providers based on matching and priority.

```ts
const registry = createRegistry<Model, string>()

registry.register({
  id: 'openai',
  priority: 10,
  match: input => input.startsWith('gpt-'),
  resolve: input => createOpenAIModel(input),
})

registry.register({
  id: 'anthropic',
  priority: 20, // Higher priority, checked first
  match: input => input.startsWith('claude-'),
  resolve: input => createAnthropicModel(input),
})

const model = await registry.resolve('claude-3-opus') // Uses anthropic provider
```

### defineProvider
Helper for type-safe provider definitions.

```ts
const openaiProvider = defineProvider<Model, string>({
  id: 'openai',
  priority: 10,
  match: input => input.startsWith('gpt-'),
  resolve: input => createOpenAIModel(input),
})

registry.register(openaiProvider)
```

### Registry Methods
#### `register(provider)`

Adds a provider. Providers are sorted by priority (highest first).

### `unregister(id)`

Removes a provider by ID. Returns `true` if found.

### `resolve(input)`

Finds first matching provider and calls its `resolve`. Returns `undefined` if no match.

### `list()`

Returns all registered providers.

### Types
```ts
interface Provider<T, Input = unknown> {
  id: string
  match: (input: Input) => boolean
  resolve: (input: Input) => Promise<T> | T
  priority?: number
}

interface Registry<T, Input = unknown> {
  register: (provider: Provider<T, Input>) => void
  unregister: (id: string) => boolean
  resolve: (input: Input) => Promise<T | undefined>
  list: () => Provider<T, Input>[]
}

interface RegistryOptions {
  defaultPriority?: number
}
```

## Examples

### Example: Tool Registry
```ts
import { createRegistry } from 'unagent/registry'

interface Tool { name: string, execute: (args: unknown) => Promise<unknown> }

const tools = createRegistry<Tool, string>({ defaultPriority: 0 })

tools.register({
  id: 'file-tools',
  match: name => ['read', 'write', 'list'].includes(name),
  resolve: name => fileTools[name],
})

tools.register({
  id: 'web-tools',
  priority: 10, // Checked before file-tools
  match: name => ['fetch', 'search'].includes(name),
  resolve: name => webTools[name],
})

const tool = await tools.resolve('fetch')
```

## Related
- [All Modules](/modules)
