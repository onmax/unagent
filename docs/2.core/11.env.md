---
icon: i-lucide-scan-search
---
# env

> Agent detection, configuration paths, and environment utilities.

## What It Solves

Agent runtimes expose different environment variables and config locations. The `env` module normalizes that detection so the rest of your code can stay portable. Use it to answer two questions reliably: which agent is running, and where that agent stores its configuration.

## When To Use It

- You need to detect the current agent to branch behavior or show diagnostics.
- You want to find installed agents by checking known config directories.
- You need stable config, cache, and data paths that follow XDG conventions.

## Usage
```ts
import { detectCurrentAgent, getAgentConfigDir, getXDGPaths } from 'unagent/env'
```

## Example: Branch Behavior By Agent

This pattern is useful for logging, feature flags, or agent-specific defaults.

```ts
import { detectCurrentAgent } from 'unagent/env'

const detected = detectCurrentAgent()
if (!detected) {
  console.log('Not running inside a supported agent runtime.')
}
else {
  console.log(`Running in ${detected.config.name} (${detected.id}) via ${detected.detected}.`)
}
```

## API

### Detection
#### `detectCurrentAgent()`

Detect which agent is currently running based on environment variables.

```ts
const agent = detectCurrentAgent()
if (agent) {
  console.log(agent.config.name) // "Claude Code"
  console.log(agent.detected) // "env" | "config" | "both"
}
```

Returns `DetectedAgent | undefined`.

### `detectInstalledAgents()`

Find all agents that are installed (have config dirs) or running.

```ts
const agents = detectInstalledAgents()
// → [{ id: 'claude-code', config: {...}, detected: 'config' }, ...]
```

### `detectAgentByEnv(agent)`

Check if a specific agent is running via its env vars.

```ts
import { agents, detectAgentByEnv } from 'unagent/env'

if (detectAgentByEnv(agents['claude-code'])) {
  console.log('Running in Claude Code')
}
```

### `isRunningInAgent(agentId)`

Check if running in a specific agent by ID.

```ts
if (isRunningInAgent('cursor')) {
  // Cursor-specific behavior
}
```

### Paths
#### `getAgentConfigDir(agent)`

Get expanded config directory path.

```ts
import { agents, getAgentConfigDir } from 'unagent/env'

const dir = getAgentConfigDir(agents['claude-code'])
// → "/Users/you/.claude"
```

### `getAgentRulesPath(agent)`

Get full path to agent's rules file.

```ts
const rulesPath = getAgentRulesPath(agents['claude-code'])
// → "/Users/you/.claude/CLAUDE.md"
```

### `getAgentSkillsDir(agent)`

Get path to agent's preferred skills directory.

```ts
const skillsDir = getAgentSkillsDir(agents['claude-code'])
// → "/Users/you/.claude/skills"
```

### `getAgentSkillsDirs(agent)`

Get all skills directories for an agent, with preferred path first.

```ts
const skillsDirs = getAgentSkillsDirs(agents['claude-code'])
// → ["/Users/you/.claude/skills", "/Users/you/.claude/.agents/skills"]
```

### `agentConfigExists(agent)`

Check if agent's config directory exists.

```ts
if (agentConfigExists(agents.cursor)) {
  console.log('Cursor is installed')
}
```

### `getXDGPaths()`

Get XDG Base Directory paths.

```ts
const xdg = getXDGPaths()
// → { data: '~/.local/share', config: '~/.config', cache: '~/.cache', state: '~/.local/state' }
```

### Agent Registry
#### `agents`

Record of all 40+ supported agents.

```ts
import { agents } from 'unagent/env'

const claude = agents['claude-code']
// → { name: 'Claude Code', configDir: '~/.claude', rulesFile: 'CLAUDE.md', ... }
```

### `getAgentConfig(agentId)`

Get config by agent ID.

```ts
const config = getAgentConfig('cursor')
```

### `getAgentIds()`

Get all agent IDs.

```ts
const ids = getAgentIds()
// → ['claude-code', 'cursor', 'windsurf', ...]
```

### `getAllAgents()`

Get all agent configs as array.

```ts
const all = getAllAgents()
```

### Environment
Re-exported from `std-env`:

```ts
import { hasTTY, isCI } from 'unagent/env'

if (hasTTY) {
  // Interactive terminal
}
```

### Types
```ts
interface AgentConfig {
  name: string
  configDir: string
  rulesFile?: string
  skillsDir?: string
  legacySkillsDirs?: string[]
  envDetect?: string[]
  description?: string
}

interface DetectedAgent {
  id: string
  config: AgentConfig
  detected: 'env' | 'config' | 'both'
}

interface XDGPaths {
  data: string
  config: string
  cache: string
  state: string
}
```

## Examples

See the usage section for common patterns.

## Related
- [Core](/core)
- [skill](/core/skill)
