---
icon: i-simple-icons-upstash
---
# QStash

> Upstash QStash provider for `unagent/queue`.

## Usage

```ts
import { createQueue } from 'unagent/queue'

const queue = await createQueue({
  provider: {
    name: 'qstash',
    token: process.env.QSTASH_TOKEN!,
    destination: 'https://example.com/api/webhook',
  },
})

await queue.send({ hello: 'world' }, { delaySeconds: 10, idempotencyKey: 'dedupe-key' })
```

You can also construct a QStash queue without `destination` for capability checks:

```ts
const queue = await createQueue({
  provider: {
    name: 'qstash',
    token: process.env.QSTASH_TOKEN!,
  },
})
```

Publishing (`send` / `sendBatch`) still requires `destination`.

## Preflight Validation

```ts
import { validateQueueConfig } from 'unagent/queue'

const preflight = validateQueueConfig({
  name: 'qstash',
  token: process.env.QSTASH_TOKEN!,
})

if (!preflight.ok)
  console.error(preflight.issues)
```

Validates that the QStash `token` is present and well-formed.

## Signature Verification

```ts
import { verifyQStashSignature } from 'unagent/queue'

const ok = await verifyQStashSignature(request, {
  currentSigningKey: process.env.QSTASH_CURRENT_SIGNING_KEY!,
  nextSigningKey: process.env.QSTASH_NEXT_SIGNING_KEY,
})
```

## API

```ts
const qstash = queue.qstash
qstash.destination
qstash.apiUrl
```

## Related
- [Queue](/features/queue)
- [All Features](/features)
- [Core](/core)
